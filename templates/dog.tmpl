{{block "dog" .}}
  <h1 class="text-xl font-bold pb-4">Dog</h1>

  <div hx-get="/dog/table?{{.QP}}"
       hx-trigger="load"
       hx-target="this"
       hx-target-error="this"
       hx-swap="outerHTML">{{template "dog-loader"}}</div>
{{end}}

{{block "dog-table" .}}
  <table class="table p-4">
    <thead>
      <tr id="reloader"
          hx-get="/dog/table"
          hx-target="closest table"
          hx-target-error="closest table"
          hx-swap="outerHTML"
          hx-indicator="#loading-indicator"
          hx-trigger="reload"
          hx-disabled-elt="{{template "dog-hx-disabled-elt"}}"
          hx-include="{{template "dog-hx-include"}}"
      >
          <th class="w-8"><div id="loading-indicator" class="htmx-indicator loading loading-spinner"></div></th>
          <th>{{template "dog-colours" .}}</th>
          <th>{{template "dog-breeds" .}}</th>
          <th>Name</th>
    </thead>
    <tbody>
      {{range .Dogs}}
        <tr>
          <td></td>
          <td>{{.Colour}}</td>
          <td>{{.Breed}}</td>
          <td>{{.Name}}</td>
        </tr>
      {{end}}
    </tbody>
  </table>
{{end}}

{{block "dog-colours" .}}
  <select name="colour"
          class="select"
          hx-on:change="htmx.trigger('#reloader', 'reload')"
  >
    {{range .Colours}}
      <option value="{{.}}"{{if eq . $.Colour}} selected{{end}}>{{title .}}</option>
    {{end}}
  </select>
{{end}}

{{block "dog-breeds" .}}
  <select name="breed"
          class="select"
          hx-on:change="htmx.trigger('#reloader', 'reload')"
  >
    {{range .Breeds}}
      <option value="{{.}}"{{if eq . $.Breed}} selected{{end}}>{{title .}}</option>
    {{end}}
  </select>
{{end}}

{{define "dog-hx-disabled-elt" -}}
[name='breed'],[name='colour']
{{- end}}

{{define "dog-hx-include" -}}
[name='breed'],[name='colour']
{{- end}}

{{define "dog-loader"}}
  <div class="skeleton w-full h-20"></div>
{{end}}
