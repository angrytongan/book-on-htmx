{{block "head" .}}
<!doctype html>
<html {{if .PageTheme}}data-theme="{{.PageTheme}}"{{end}}>
  <head>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="stylesheet" href="/css/style.css" />

    <!-- Google Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&display=block&icon_names=dashboard,home,map,menu,notifications,palette,pets,search,settings,tab,terminal" />

    <!-- htmx -->
    <script type="text/javascript" src="/js/htmx@2.0.6.min.js"></script>
    <script type="text/javascript" src="/js/hyperscript@0.9.14.min.js"></script>
    <script type="text/javascript" src="/js/htmx-ext-reponse-targets@2.0.2.min.js"></script>
    <meta name="htmx-config" content='{"historyCacheSize": 0,"refreshOnHistoryMiss": true, "responseTargetUnsetsError": false}'>

    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
       integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
       crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
       integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
       crossorigin=""></script>
    </script>
    <script type="text/javascript" src="/js/map.js"></script>

    <!-- local utilities -->
    <script type="text/javascript" src="/js/scrollto.js"></script>
    <script type="text/javascript" src="/js/visible.js"></script>
    <script type="text/javascript" src="/js/textarea-tabs.js"></script>

    <script type="text/hyperscript">
      on load restoreScrollTop()
    </script>

  </head>

  <body hx-history="false"
        hx-ext="response-targets">
{{end}}

{{block "nav-head" .}}
    <div class="flex flex-col">
        <progress id="loading-indicator" class="progress htmx-indicator z-50"></progress>
        
        <!-- Unified responsive navigation -->
        <aside class="fixed bg-base-200 z-40
                      top-0 left-0 right-0 h-16 overflow-x-auto
                      md:h-screen md:w-32 md:right-auto md:overflow-y-auto">
            <nav id="nav">
                {{block "nav" .}}
                    <ul class="menu gap-2 
                               menu-horizontal min-w-max px-2 h-16
                               md:menu-vertical md:w-32 md:min-w-0 md:px-0 md:h-auto">
                        {{range .Nav}}
                            <li><a href="{{.Href}}"
                                   class="{{if .Active}}menu-active{{end}} 
                                          flex-col gap-1 min-w-max px-3
                                          md:flex-row md:gap-2 md:min-w-0 md:px-4"
                                   hx-get="{{.Href}}"
                                   hx-trigger="click"
                                   hx-target="#main"
                                   hx-target-error="#main"
                                   hx-swap="innerHTML"
                                   hx-push-url="true"
                                   hx-indicator="#loading-indicator"
                                   ><span class="material-symbols-outlined text-sm md:text-base">{{.Icon}}</span><span class="hidden md:inline">{{.Label}}</span></a></li>
                        {{end}}
                    </ul>
                {{end}}
            </nav>
        </aside>
        
        <div class="flex flex-row h-screen pt-16 md:pt-0"> <!-- page wrapper -->

            <main id="main" class="flex-1 ml-0 md:ml-32 p-2 overflow-y-auto"
                _="on scroll debounced at 200ms call saveScrollTop(event)"
            >
{{end}}

{{block "nav-foot" .}}
          </main>
        </div>
    </div>
{{end}}

{{block "foot" .}}
  </body>
</html>
{{end}}
